<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
</head>
<body>
    <div class="ui top fixed menu">
        <div class="header item">
            <img src="img/logo-egon-animated.gif" alt="Logo" style="width:30%;height:30%;">
        </div>
    </div>
    <div class="ui container" style="padding-top: 10em">
        <div class="ui form">
            <div class="field">
                <label>Dropdown Filter</label>
                <select id="dropdownFilter" multiple class="ui fluid dropdown">
                    <option value="paysafecard">Option 1</option>
                    <option value="banktransfer">Option 2</option>
                    <option value="option3">Option 3</option>
                </select>
            </div>
            <div class="field">
                <label>Checkbox Filters</label>
                <div class="ui checkbox">
                    <input type="checkbox" id="checkboxFilter1">
                    <label>Checkbox 1</label>
                </div>
                <div class="ui checkbox">
                    <input type="checkbox" id="checkboxFilter2">
                    <label>Checkbox 2</label>
                </div>
                <div class="ui checkbox">
                    <input type="checkbox" id="checkboxFilter3">
                    <label>Checkbox 3</label>
                </div>
            </div>
        </div>
        <div id="dataContainer"></div>
    </div>

    <script>
        // Fetch API based on selected filters
        function fetchData() {
            // Get selected dropdown values
            const dropdownValues = $('#dropdownFilter').dropdown('get value');
            
            // Get checkbox values
            const checkbox1Value = $('#checkboxFilter1').is(':checked');
            const checkbox2Value = $('#checkboxFilter2').is(':checked');
            const checkbox3Value = $('#checkboxFilter3').is(':checked');
            
            // Construct API URL with selected filters
            const apiUrl = `http://127.0.0.1:3000/api/casinos/htmldiv/?bonushunt=${checkbox1Value}&checkbox2=${checkbox2Value}&checkbox3=${checkbox3Value}`;
            
            // Fetch API data
            fetch(apiUrl)
                .then(response => response.text())
                .then(data => {
                        console.log(data);
                    // Add API data to the data container
                    $('#dataContainer').html(data);
                })
                .catch(error => {
                    console.error('Error fetching API data:', error);
                });
        }
        
        // Pre-set dropdown and checkboxes from URL variables
        function setFiltersFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Set dropdown filter
            const dropdownFilterValues = urlParams.getAll('dropdown');
            $('#dropdownFilter').dropdown('set selected', dropdownFilterValues);
            
            // Set checkbox filters
            const checkbox1Value = urlParams.get('checkbox1');
            const checkbox2Value = urlParams.get('checkbox2');
            const checkbox3Value = urlParams.get('checkbox3');
            $('#checkboxFilter1').prop('checked', checkbox1Value === 'true');
            $('#checkboxFilter2').prop('checked', checkbox2Value === 'true');
            $('#checkboxFilter3').prop('checked', checkbox3Value === 'true');
        }
        
        // Fetch data each time the filters are changed
        $('#dropdownFilter, #checkboxFilter1, #checkboxFilter2, #checkboxFilter3').on('change', fetchData);
        
        // Initialize dropdown and set filters from URL
        $(document).ready(function() {
            $('#dropdownFilter').dropdown();
            setFiltersFromUrl();
            fetchData();
        });
    </script>
</body>
</html>
